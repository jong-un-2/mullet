"use strict";(self.webpackChunkmars_admin=self.webpackChunkmars_admin||[]).push([[3072],{49980:function(e,t,n){n.d(t,{g4:function(){return s}});var r=0,a=100;function s(){return 0===a?0:r/a*100}},39903:function(e,t,n){n.r(t);var r=n(15009),a=n.n(r),s=n(97857),i=n.n(s),c=n(99289),o=n.n(c),l=n(5574),u=n.n(l),d=n(67294),p=n(90930),h=n(98142),x=n(34041),f=n(2453),m=n(4393),v=n(78957),y=n(83622),g=n(71230),j=n(15746),F=n(4930),b=n(78677),Z=n(63430),S=n(80652),k=n(69753),P=n(27484),w=n.n(P),C=n(75427),T=n(49980),D=n(85893),R=h.default.RangePicker,U=x.Z.Option;t.default=function(){var e=(0,d.useState)(!1),t=u()(e,2),n=t[0],r=t[1],s=(0,d.useState)([w()().subtract(30,"days"),w()()]),c=u()(s,2),l=c[0],h=c[1],P=(0,d.useState)("day"),A=u()(P,2),I=A[0],O=A[1],z=(0,d.useState)([]),_=u()(z,2),M=_[0],N=_[1],q=(0,d.useState)([]),B=u()(q,2),W=B[0],E=B[1],Y=(0,d.useState)({totalFee:0,totalTransactions:0,avgFee:0,activeUsers:0,currentFeeRate:(0,T.g4)()}),H=u()(Y,2),V=H[0],K=H[1],L=[{title:"排名",key:"rank",width:60,render:function(e,t,n){return n+1}},{title:"用户地址",dataIndex:"user",key:"user",ellipsis:!0,render:function(e){return(0,D.jsxs)("span",{title:e,style:{fontFamily:"monospace"},children:[e.slice(0,8),"...",e.slice(-8)]})}},{title:"总费用 (PYUSD)",dataIndex:"totalFee",key:"totalFee",align:"right",render:function(e){return(0,D.jsx)("span",{style:{fontWeight:"bold",fontFamily:"monospace"},children:"number"==typeof e?e.toFixed(6):"0.000000"})},sorter:function(e,t){return e.totalFee-t.totalFee}},{title:"交易次数",dataIndex:"transactionCount",key:"transactionCount",align:"right",sorter:function(e,t){return e.transactionCount-t.transactionCount}},{title:"最后交易",dataIndex:"lastTransaction",key:"lastTransaction",render:function(e){return w()(e).format("MM-DD HH:mm")}}],G={data:M,xField:"date",yField:"totalFee",meta:{totalFee:{alias:"平台费用 (PYUSD)"},date:{alias:"日期"}},label:{position:"middle",style:{fill:"#FFFFFF",opacity:.6}}},J={data:[{type:"PYUSD奖励",value:V.totalFee*(100-V.currentFeeRate)/V.currentFeeRate,percentage:100-V.currentFeeRate},{type:"平台费用",value:V.totalFee,percentage:V.currentFeeRate}],angleField:"value",colorField:"type",radius:.8,label:{type:"outer",content:"{name}: {percentage}%"},interactions:[{type:"element-active"}]},Q={data:M,xField:"date",yField:"transactionCount",point:{size:5,shape:"diamond"},meta:{transactionCount:{alias:"交易数量"},date:{alias:"日期"}}},X=function(){var e=o()(a()().mark((function e(){var t,n,s,c,o,d;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(!0),e.prev=1,t={startDate:l[0].toISOString(),endDate:l[1].toISOString()},e.next=5,Promise.all([(0,C.Vk)(t),(0,C.lP)(i()(i()({},t),{},{limit:10})),(0,C.M2)(i()(i()({},t),{},{timeUnit:I}))]);case 5:n=e.sent,s=u()(n,3),c=s[0],o=s[1],d=s[2],K(c),E(o),N(d),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),f.ZP.error("加载统计数据失败"),console.error("加载统计数据错误:",e.t0);case 19:return e.prev=19,r(!1),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[1,15,19,22]])})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){X()}),[l,I]);return(0,D.jsxs)(p._z,{header:{title:"佣金费用统计",breadcrumb:{routes:[{path:"/",breadcrumbName:"首页"},{path:"/commission",breadcrumbName:"佣金费用"},{path:"/commission/statistics",breadcrumbName:"统计报表"}]}},children:[(0,D.jsx)(m.Z,{style:{marginBottom:24},children:(0,D.jsxs)(v.Z,{style:{marginBottom:16},children:[(0,D.jsx)(R,{value:l,onChange:function(e){e&&e[0]&&e[1]&&h([e[0],e[1]])}}),(0,D.jsxs)(x.Z,{value:I,onChange:O,style:{width:100},children:[(0,D.jsx)(U,{value:"day",children:"按天"}),(0,D.jsx)(U,{value:"week",children:"按周"}),(0,D.jsx)(U,{value:"month",children:"按月"})]}),(0,D.jsx)(y.ZP,{type:"primary",icon:(0,D.jsx)(k.Z,{}),onClick:function(){console.log("导出统计数据")},children:"导出报表"})]})}),(0,D.jsxs)(g.Z,{gutter:[16,16],children:[(0,D.jsx)(j.Z,{xs:24,lg:12,children:(0,D.jsx)(m.Z,{title:"平台费用趋势",loading:n,children:(0,D.jsx)(b.Z,i()({},G))})}),(0,D.jsx)(j.Z,{xs:24,lg:12,children:(0,D.jsx)(m.Z,{title:"费用占比分析",loading:n,children:(0,D.jsx)(Z.Z,i()({},J))})})]}),(0,D.jsxs)(g.Z,{gutter:[16,16],style:{marginTop:16},children:[(0,D.jsx)(j.Z,{xs:24,lg:12,children:(0,D.jsx)(m.Z,{title:"交易数量趋势",loading:n,children:(0,D.jsx)(S.Z,i()({},Q))})}),(0,D.jsx)(j.Z,{xs:24,lg:12,children:(0,D.jsx)(m.Z,{title:"用户费用排行榜",loading:n,children:(0,D.jsx)(F.Z,{columns:L,dataSource:W,rowKey:"user",pagination:!1,size:"small"})})})]}),(0,D.jsx)(m.Z,{title:"统计摘要",style:{marginTop:16},children:(0,D.jsxs)(g.Z,{gutter:[16,16],children:[(0,D.jsx)(j.Z,{xs:12,sm:6,children:(0,D.jsxs)("div",{style:{textAlign:"center"},children:[(0,D.jsx)("div",{style:{fontSize:24,fontWeight:"bold",color:"#1890ff"},children:"number"==typeof V.totalFee?V.totalFee.toFixed(6):"0.000000"}),(0,D.jsx)("div",{style:{color:"#666"},children:"总平台费用 (PYUSD)"})]})}),(0,D.jsx)(j.Z,{xs:12,sm:6,children:(0,D.jsxs)("div",{style:{textAlign:"center"},children:[(0,D.jsx)("div",{style:{fontSize:24,fontWeight:"bold",color:"#52c41a"},children:V.totalTransactions}),(0,D.jsx)("div",{style:{color:"#666"},children:"总交易数量"})]})}),(0,D.jsx)(j.Z,{xs:12,sm:6,children:(0,D.jsxs)("div",{style:{textAlign:"center"},children:[(0,D.jsx)("div",{style:{fontSize:24,fontWeight:"bold",color:"#722ed1"},children:V.activeUsers}),(0,D.jsx)("div",{style:{color:"#666"},children:"活跃用户数"})]})}),(0,D.jsx)(j.Z,{xs:12,sm:6,children:(0,D.jsxs)("div",{style:{textAlign:"center"},children:[(0,D.jsxs)("div",{style:{fontSize:24,fontWeight:"bold",color:"#fa8c16"},children:[V.currentFeeRate,"%"]}),(0,D.jsx)("div",{style:{color:"#666"},children:"当前费率"})]})})]})})]})}},75427:function(e,t,n){n.d(t,{BM:function(){return u},M2:function(){return m},Vk:function(){return p},lP:function(){return x}});var r=n(15009),a=n.n(r),s=n(99289),i=n.n(s),c=n(21836),o=n(49980),l={NODE_ENV:"production",PUBLIC_PATH:"/"}.MARS_BACKEND_API||"https://api.marsliquidity.com";function u(e){return d.apply(this,arguments)}function d(){return(d=i()(a()().mark((function e(t){var n;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,c.request)("".concat(l,"/api/neon/commission-records"),{method:"POST",data:t});case 3:return n=e.sent,e.abrupt("return",{data:n.data||[],success:n.success,total:n.total||0});case 7:return e.prev=7,e.t0=e.catch(0),console.error("获取佣金记录失败:",e.t0),e.abrupt("return",{data:[],success:!1,total:0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function p(e){return h.apply(this,arguments)}function h(){return(h=i()(a()().mark((function e(t){var n;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,c.request)("".concat(l,"/api/neon/commission-statistics"),{method:"POST",data:t});case 3:return n=e.sent,e.abrupt("return",n.data||{totalFee:0,totalTransactions:0,avgFee:0,activeUsers:0,currentFeeRate:(0,o.g4)()});case 7:return e.prev=7,e.t0=e.catch(0),console.error("获取统计数据失败:",e.t0),e.abrupt("return",{totalFee:0,totalTransactions:0,avgFee:0,activeUsers:0,currentFeeRate:(0,o.g4)()});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function x(e){return f.apply(this,arguments)}function f(){return(f=i()(a()().mark((function e(t){var n;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,c.request)("".concat(l,"/api/neon/user-statistics"),{method:"POST",data:t});case 3:return n=e.sent,e.abrupt("return",n.data||[]);case 7:return e.prev=7,e.t0=e.catch(0),console.error("获取用户统计失败:",e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=i()(a()().mark((function e(t){var n;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,c.request)("".concat(l,"/api/neon/trend-data"),{method:"POST",data:t});case 3:return n=e.sent,e.abrupt("return",n.data||[]);case 7:return e.prev=7,e.t0=e.catch(0),console.error("获取趋势数据失败:",e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}}}]);