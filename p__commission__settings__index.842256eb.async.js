"use strict";(self.webpackChunkmars_admin=self.webpackChunkmars_admin||[]).push([[2695],{6285:function(e,a,t){t.r(a),t.d(a,{default:function(){return N}});var n=t(67294),r=t(15009),s=t.n(r),o=t(99289),i=t.n(o),m=t(5574),d=t.n(m),u=t(74470),c=t(116),l=t(2453),p=t(24426),_=t(78957),y=t(38925),b=t(4393),k=t(96074),f=t(74330),g=t(37804),v=t(83622),h=t(55102),w=t(16009),x=t(44718),P=t(54306),A=t(6084),T=t(90930),S=t(30527),V=JSON.parse('{"address":"Dfr6zir7nV2DWduqhtHNdkJn4mMxHf9G8muQSatiZ1k9","metadata":{"name":"mars","version":"0.1.0","spec":"0.1.0","description":"Created with Anchor"},"instructions":[{"name":"accept_authority","discriminator":[107,86,198,91,33,12,107,160],"accounts":[{"name":"new_admin","writable":true,"signer":true},{"name":"global_state","writable":true,"pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}}],"args":[]},{"name":"add_freeze_authority","discriminator":[104,73,122,138,173,18,136,2],"accounts":[{"name":"admin","writable":true,"signer":true},{"name":"global_state","pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}},{"name":"global_state_authority","writable":true,"pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,97,117,116,104,111,114,105,116,121]}]}},{"name":"system_program","address":"11111111111111111111111111111111"}],"args":[{"name":"authority_address","type":"pubkey"}]},{"name":"add_thaw_authority","discriminator":[73,238,59,82,240,0,171,242],"accounts":[{"name":"admin","writable":true,"signer":true},{"name":"global_state","pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}},{"name":"global_state_authority","writable":true,"pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,97,117,116,104,111,114,105,116,121]}]}},{"name":"system_program","address":"11111111111111111111111111111111"}],"args":[{"name":"authority_address","type":"pubkey"}]},{"name":"claim_all_fees","docs":["管理员提取 Vault 所有累积的费用"],"discriminator":[47,242,187,73,134,67,102,22],"accounts":[{"name":"admin","docs":["管理员（必须是 vault 的 admin）"],"writable":true,"signer":true},{"name":"vault_state","docs":["Mars Vault 状态账户"],"writable":true,"pda":{"seeds":[{"kind":"const","value":[118,97,117,108,116,45,115,116,97,116,101]},{"kind":"account","path":"vault_state.vault_id","account":"VaultState"}]}},{"name":"vault_treasury","docs":["Mars Vault 的代币金库（费用存储处）"],"writable":true,"pda":{"seeds":[{"kind":"const","value":[118,97,117,108,116,45,116,114,101,97,115,117,114,121]},{"kind":"account","path":"vault_state.vault_id","account":"VaultState"}]}},{"name":"admin_token_account","docs":["管理员的代币账户（接收费用）"],"writable":true},{"name":"token_program","address":"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"}],"args":[]},{"name":"claim_farm_rewards","docs":["用户领取 Farm 奖励","reward_index: 0 或 1，表示要领取第几个奖励"],"discriminator":[102,40,223,149,90,81,228,23],"accounts":[{"name":"user","docs":["用户账户"],"writable":true,"signer":true},{"name":"global_state","docs":["Global state - 用于记录和收取手续费","Must be initialized via initialize instruction"],"writable":true,"pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}},{"name":"vault_state","docs":["Vault state - PYUSD vault","Must be initialized separately before claiming rewards"],"writable":true,"pda":{"seeds":[{"kind":"const","value":[118,97,117,108,116,45,115,116,97,116,101]},{"kind":"account","path":"vault_state.vault_id","account":"VaultState"}]}},{"name":"vault_mint","docs":["Vault mint (PYUSD) - the base token for this vault"]},{"name":"farm_state","docs":["Farm state 账户"],"writable":true},{"name":"user_farm","docs":["User farm 账户"],"writable":true},{"name":"global_config","docs":["Global Config (Kamino)"]},{"name":"reward_mint","docs":["Reward Token Mint"]},{"name":"reward_vault","docs":["Reward Vault (farm 的奖励池)"],"writable":true},{"name":"treasury_vault","docs":["Treasury Vault (Kamino treasury)"],"writable":true},{"name":"user_reward_ata","docs":["User Reward Token ATA (用户接收奖励的账户)","使用 UncheckedAccount 以支持 Token-2022 (不再硬编码 SPL Token owner check)"],"writable":true},{"name":"platform_fee_ata","docs":["Platform Fee Reward Token ATA (平台收取费用的账户)","必须与 global_state.platform_fee_wallet 匹配以确保安全性"],"writable":true},{"name":"farm_authority","docs":["Farm Authority PDA (用于签名)"]},{"name":"scope_prices","docs":["Scope Prices (optional, can be Program ID if not used)"]},{"name":"farms_program","docs":["Kamino Farms 程序"]},{"name":"reward_token_program","docs":["Reward Token program (支持 SPL Token 和 Token-2022)"]},{"name":"system_program","docs":["System program"],"address":"11111111111111111111111111111111"}],"args":[{"name":"reward_index","type":"u64"}]},{"name":"claim_fees","docs":["管理员提取 Vault 累积的费用（按类型）"],"discriminator":[82,251,233,156,12,52,184,202],"accounts":[{"name":"admin","docs":["管理员（必须是 vault 的 admin）"],"writable":true,"signer":true},{"name":"vault_state","docs":["Mars Vault 状态账户"],"writable":true,"pda":{"seeds":[{"kind":"const","value":[118,97,117,108,116,45,115,116,97,116,101]},{"kind":"account","path":"vault_state.vault_id","account":"VaultState"}]}},{"name":"vault_treasury","docs":["Mars Vault 的代币金库（费用存储处）"],"writable":true,"pda":{"seeds":[{"kind":"const","value":[118,97,117,108,116,45,116,114,101,97,115,117,114,121]},{"kind":"account","path":"vault_state.vault_id","account":"VaultState"}]}},{"name":"admin_token_account","docs":["管理员的代币账户（接收费用）"],"writable":true},{"name":"token_program","address":"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"}],"args":[{"name":"amount","type":"u64"},{"name":"fee_type","type":{"defined":{"name":"FeeType"}}}]},{"name":"freeze_global_state","discriminator":[34,7,180,252,211,157,15,159],"accounts":[{"name":"signer","writable":true,"signer":true},{"name":"global_state","writable":true,"pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}},{"name":"global_state_authority","pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,97,117,116,104,111,114,105,116,121]}]}},{"name":"system_program","address":"11111111111111111111111111111111"}],"args":[]},{"name":"initialize","discriminator":[175,175,109,31,13,152,155,237],"accounts":[{"name":"admin","writable":true,"signer":true},{"name":"global_state","writable":true,"pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}},{"name":"asset","writable":true,"pda":{"seeds":[{"kind":"const","value":[97,115,115,101,116,45,115,101,101,100]}]}},{"name":"vault","writable":true,"pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,118,97,117,108,116]}]}},{"name":"ata_vault","writable":true,"pda":{"seeds":[{"kind":"account","path":"vault"},{"kind":"const","value":[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{"kind":"account","path":"usdc_mint"}],"program":{"kind":"const","value":[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{"name":"usdc_mint"},{"name":"token_program","address":"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{"name":"associated_token_program","address":"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{"name":"system_program","address":"11111111111111111111111111111111"}],"args":[{"name":"platform_fee_wallet","type":{"option":"pubkey"}}]},{"name":"initialize_vault","docs":["初始化新的金库"],"discriminator":[48,191,163,44,71,129,63,164],"accounts":[{"name":"admin","docs":["管理员账户 - 必须是 global admin"],"writable":true,"signer":true},{"name":"global_state","docs":["Global state - 必须已经初始化"],"pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}},{"name":"vault_state","docs":["Vault state - 要初始化的账户"],"writable":true,"pda":{"seeds":[{"kind":"const","value":[118,97,117,108,116,45,115,116,97,116,101]},{"kind":"arg","path":"vault_id"}]}},{"name":"base_token_mint","docs":["基础代币 Mint (例如 USDC, PYUSD)","支持 SPL Token 和 Token-2022"]},{"name":"shares_mint","docs":["份额代币 Mint (代表用户在 vault 中的权益)","注意：需要预先创建好"]},{"name":"vault_treasury","docs":["Vault Treasury (PDA)"],"pda":{"seeds":[{"kind":"const","value":[118,97,117,108,116,45,116,114,101,97,115,117,114,121]},{"kind":"arg","path":"vault_id"}]}},{"name":"token_program","address":"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{"name":"system_program","address":"11111111111111111111111111111111"}],"args":[{"name":"vault_id","type":{"array":["u8",32]}},{"name":"platform_fee_bps","type":"u16"}]},{"name":"kamino_deposit","discriminator":[237,8,188,187,115,99,49,85],"accounts":[{"name":"user","docs":["1. user - 用户账户"],"writable":true,"signer":true},{"name":"vault_state","docs":["2. vaultState - Kamino Vault状态账户"],"writable":true},{"name":"token_vault","docs":["3. tokenVault - Vault的代币金库"],"writable":true},{"name":"token_mint","docs":["4. tokenMint - 代币铸造账户（如USDC）"]},{"name":"base_vault_authority","docs":["5. baseVaultAuthority - Vault权限PDA"]},{"name":"shares_mint","docs":["6. sharesMint - 份额铸造账户"],"writable":true},{"name":"user_token_ata","docs":["7. userTokenAta - 用户的代币ATA（源）"],"writable":true},{"name":"user_shares_ata","docs":["8. userSharesAta - 用户的份额ATA（接收份额）"],"writable":true},{"name":"klend_program","docs":["9. klendProgram - Klend程序"]},{"name":"token_program","docs":["10. tokenProgram - Token程序（支持 Token 或 Token-2022）"]},{"name":"shares_token_program","docs":["11. sharesTokenProgram - 份额Token程序（通常与tokenProgram相同）"]},{"name":"event_authority","docs":["12. eventAuthority - 事件权限PDA"]},{"name":"kamino_vault_program","docs":["13. program - Kamino Vault程序自身"]}],"args":[{"name":"max_amount","type":"u64"}]},{"name":"kamino_deposit_and_stake","discriminator":[42,143,36,40,74,180,200,42],"accounts":[{"name":"user","docs":["1. user - 用户账户"],"writable":true,"signer":true},{"name":"vault_state","docs":["2. vaultState - Kamino Vault状态账户"],"writable":true},{"name":"token_vault","docs":["3. tokenVault - Vault的代币金库"],"writable":true},{"name":"token_mint","docs":["4. tokenMint - 代币铸造账户（如PYUSD）"]},{"name":"base_vault_authority","docs":["5. baseVaultAuthority - Vault权限PDA"]},{"name":"shares_mint","docs":["6. sharesMint - 份额铸造账户"],"writable":true},{"name":"user_token_ata","docs":["7. userTokenAta - 用户的代币ATA（源）"],"writable":true},{"name":"user_shares_ata","docs":["8. userSharesAta - 用户的份额ATA"],"writable":true},{"name":"klend_program","docs":["9. klendProgram - Klend程序"]},{"name":"token_program","docs":["10. tokenProgram - Token程序"]},{"name":"shares_token_program","docs":["11. sharesTokenProgram - 份额Token程序"]},{"name":"event_authority","docs":["12. eventAuthority - 事件权限PDA"]},{"name":"kamino_vault_program","docs":["13. kaminoVaultProgram - Kamino Vault程序"]},{"name":"farm_state","docs":["14. farmState - Farm state 账户"],"writable":true},{"name":"user_farm","docs":["15. userFarm - 用户在 farm 中的质押记录"],"writable":true},{"name":"delegated_stake","docs":["16. delegatedStake - 委托质押账户"],"writable":true},{"name":"farms_program","docs":["17. farmsProgram - Kamino Farms 程序"]},{"name":"farm_token_program","docs":["18. farmTokenProgram - Farm 使用的 Token 程序（通常是普通 Token Program）"]}],"args":[{"name":"max_amount","type":"u64"}]},{"name":"kamino_stake_in_farm","discriminator":[24,191,24,158,110,190,234,15],"accounts":[{"name":"user","docs":["用户账户"],"writable":true,"signer":true},{"name":"farm_state","docs":["Farm state 账户"],"writable":true},{"name":"user_farm","docs":["User farm 账户（用户在 farm 中的质押记录）"],"writable":true},{"name":"delegated_stake","docs":["Delegated stake（委托质押账户）"],"writable":true},{"name":"user_shares_ata","docs":["用户的 shares token 账户"],"writable":true},{"name":"shares_mint","docs":["Shares mint"]},{"name":"farms_program","docs":["Kamino Farms 程序"]},{"name":"token_program","docs":["Token program (支持 Token 或 Token-2022)"]}],"args":[{"name":"shares_amount","type":"u64"}]},{"name":"kamino_start_unstake_from_farm","discriminator":[69,169,100,27,224,93,160,125],"accounts":[{"name":"user","docs":["用户账户"],"writable":true,"signer":true},{"name":"farm_state","docs":["Farm state 账户"],"writable":true},{"name":"user_farm","docs":["User farm 账户"],"writable":true},{"name":"farms_program","docs":["Kamino Farms 程序"]}],"args":[{"name":"shares_amount","type":"u64"},{"name":"current_slot","type":"u64"}]},{"name":"kamino_unstake_from_farm","discriminator":[147,182,155,59,74,113,23,203],"accounts":[{"name":"user","docs":["用户账户"],"writable":true,"signer":true},{"name":"farm_state","docs":["Farm state 账户"],"writable":true},{"name":"user_farm","docs":["User farm 账户"],"writable":true},{"name":"user_shares_ata","docs":["用户的 shares token 账户"],"writable":true},{"name":"delegated_stake","docs":["Delegated stake 账户"],"writable":true},{"name":"scope_prices","docs":["Scope prices 账户（用于价格 oracle）"]},{"name":"token_program","docs":["Token program"]},{"name":"farms_program","docs":["Kamino Farms 程序"]}],"args":[]},{"name":"kamino_withdraw","discriminator":[199,101,41,45,213,98,224,200],"accounts":[{"name":"user","docs":["withdrawFromAvailable 部分","1. user"],"writable":true,"signer":true},{"name":"vault_state","docs":["2. vaultState"],"writable":true},{"name":"token_vault","docs":["3. tokenVault"],"writable":true},{"name":"base_vault_authority","docs":["4. baseVaultAuthority"]},{"name":"user_token_ata","docs":["5. userTokenAta - 用户接收代币的ATA"],"writable":true},{"name":"token_mint","docs":["6. tokenMint"],"writable":true},{"name":"user_shares_ata","docs":["7. userSharesAta - 用户销毁份额的ATA"],"writable":true},{"name":"shares_mint","docs":["8. sharesMint"],"writable":true},{"name":"token_program","docs":["9. tokenProgram - Token程序（支持 Token 或 Token-2022）"]},{"name":"shares_token_program","docs":["10. sharesTokenProgram"]},{"name":"klend_program","docs":["11. klendProgram"]},{"name":"event_authority","docs":["12. eventAuthority"]},{"name":"kamino_vault_program","docs":["13. program"]}],"args":[{"name":"max_amount","type":"u64"}]},{"name":"nominate_authority","discriminator":[148,182,144,91,186,12,118,18],"accounts":[{"name":"admin","writable":true,"signer":true},{"name":"global_state","writable":true,"pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}}],"args":[{"name":"new_admin","type":"pubkey"}]},{"name":"remove_bridge_liquidity","discriminator":[179,49,66,73,130,250,201,55],"accounts":[{"name":"admin","writable":true,"signer":true},{"name":"global_state","pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}},{"name":"asset","pda":{"seeds":[{"kind":"const","value":[97,115,115,101,116,45,115,101,101,100]}]}},{"name":"ata_admin","writable":true,"pda":{"seeds":[{"kind":"account","path":"admin"},{"kind":"const","value":[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{"kind":"account","path":"usdc_mint"}],"program":{"kind":"const","value":[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{"name":"vault","pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,118,97,117,108,116]}]}},{"name":"ata_vault","writable":true,"pda":{"seeds":[{"kind":"account","path":"vault"},{"kind":"const","value":[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{"kind":"account","path":"usdc_mint"}],"program":{"kind":"const","value":[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{"name":"usdc_mint"},{"name":"token_program","address":"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{"name":"associated_token_program","address":"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{"name":"system_program","address":"11111111111111111111111111111111"}],"args":[{"name":"amount","type":"u64"}]},{"name":"remove_freeze_authority","discriminator":[121,158,157,79,142,222,54,70],"accounts":[{"name":"admin","writable":true,"signer":true},{"name":"global_state","pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}},{"name":"global_state_authority","writable":true,"pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,97,117,116,104,111,114,105,116,121]}]}},{"name":"system_program","address":"11111111111111111111111111111111"}],"args":[{"name":"authority_address","type":"pubkey"}]},{"name":"remove_thaw_authority","discriminator":[145,237,185,116,80,163,164,0],"accounts":[{"name":"admin","writable":true,"signer":true},{"name":"global_state","pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}},{"name":"global_state_authority","writable":true,"pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,97,117,116,104,111,114,105,116,121]}]}},{"name":"system_program","address":"11111111111111111111111111111111"}],"args":[{"name":"authority_address","type":"pubkey"}]},{"name":"set_fee_tiers","discriminator":[162,35,72,250,39,183,30,7],"accounts":[{"name":"admin","writable":true,"signer":true},{"name":"global_state","pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}},{"name":"fee_tiers","writable":true,"pda":{"seeds":[{"kind":"const","value":[102,101,101,45,116,105,101,114,115,45,115,101,101,100]}]}},{"name":"system_program","address":"11111111111111111111111111111111"},{"name":"token_program","address":"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{"name":"associated_token_program","address":"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"}],"args":[{"name":"threshold_amounts","type":{"vec":"u64"}},{"name":"bps_fees","type":{"vec":"u64"}}]},{"name":"set_insurance_fee_tiers","discriminator":[108,36,251,190,234,233,238,9],"accounts":[{"name":"admin","writable":true,"signer":true},{"name":"global_state","pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}},{"name":"insurance_fee_tiers","writable":true,"pda":{"seeds":[{"kind":"const","value":[105,110,115,117,114,97,110,99,101,45,102,101,101,45,116,105,101,114,115,45,115,101,101,100]}]}},{"name":"system_program","address":"11111111111111111111111111111111"},{"name":"token_program","address":"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{"name":"associated_token_program","address":"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"}],"args":[{"name":"threshold_amounts","type":{"vec":"u64"}},{"name":"insurance_fees","type":{"vec":"u64"}}]},{"name":"set_protocol_fee_fraction","discriminator":[65,45,161,40,86,227,224,106],"accounts":[{"name":"admin","writable":true,"signer":true},{"name":"global_state","pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}},{"name":"protocol_fee_fraction","writable":true,"pda":{"seeds":[{"kind":"const","value":[112,114,111,116,111,99,111,108,45,102,101,101,45,102,114,97,99,116,105,111,110,45,115,101,101,100]}]}},{"name":"system_program","address":"11111111111111111111111111111111"},{"name":"token_program","address":"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{"name":"associated_token_program","address":"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"}],"args":[{"name":"protocol_fee_numerator","type":"u64"},{"name":"protocol_fee_denominator","type":"u64"}]},{"name":"set_target_chain_min_fee","discriminator":[188,94,251,31,201,17,101,24],"accounts":[{"name":"admin","writable":true,"signer":true},{"name":"global_state","pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}},{"name":"target_chain_min_fee","writable":true,"pda":{"seeds":[{"kind":"arg","path":"dest_chain_id"},{"kind":"account","path":"usdc_mint"},{"kind":"const","value":[109,97,114,115,45,116,97,114,103,101,116,45,99,104,97,105,110,45,109,105,110,45,102,101,101]}]}},{"name":"usdc_mint"},{"name":"system_program","address":"11111111111111111111111111111111"},{"name":"token_program","address":"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{"name":"associated_token_program","address":"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"}],"args":[{"name":"dest_chain_id","type":"u32"},{"name":"min_fee","type":"u64"}]},{"name":"thaw_global_state","discriminator":[4,19,152,159,108,253,65,170],"accounts":[{"name":"signer","writable":true,"signer":true},{"name":"global_state","writable":true,"pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}},{"name":"global_state_authority","pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,97,117,116,104,111,114,105,116,121]}]}},{"name":"system_program","address":"11111111111111111111111111111111"}],"args":[]},{"name":"update_global_state_params","discriminator":[224,96,64,85,83,70,233,77],"accounts":[{"name":"admin","writable":true,"signer":true},{"name":"global_state","writable":true,"pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}}],"args":[{"name":"rebalance_threshold","type":{"option":"u16"}},{"name":"cross_chain_fee_bps","type":{"option":"u16"}},{"name":"max_order_amount","type":{"option":"u64"}}]},{"name":"update_platform_fee_wallet","docs":["管理员更新平台费用钱包地址","new_platform_fee_wallet: 新的平台费用接收钱包地址"],"discriminator":[135,108,214,52,224,155,54,136],"accounts":[{"name":"admin","docs":["Admin/Authority"],"writable":true,"signer":true},{"name":"global_state","docs":["Global state"],"writable":true,"pda":{"seeds":[{"kind":"const","value":[109,97,114,115,45,103,108,111,98,97,108,45,115,116,97,116,101,45,115,101,101,100]}]}}],"args":[{"name":"new_platform_fee_wallet","type":"pubkey"}]},{"name":"update_vault_platform_fee","docs":["管理员更新 Vault 的平台费率配置","new_platform_fee_bps: 新的平台费率（basis points，如 2500 = 25%）"],"discriminator":[208,205,133,177,57,233,123,127],"accounts":[{"name":"admin","docs":["Admin 账户"],"writable":true,"signer":true},{"name":"vault_state","docs":["Vault state 账户"],"writable":true,"pda":{"seeds":[{"kind":"const","value":[118,97,117,108,116,45,115,116,97,116,101]},{"kind":"account","path":"vault_state.vault_id","account":"VaultState"}]}}],"args":[{"name":"new_platform_fee_bps","type":"u16"}]},{"name":"vault_deposit","docs":["用户存款到金库"],"discriminator":[231,150,41,113,180,104,162,120],"accounts":[{"name":"user","writable":true,"signer":true},{"name":"user_token_account","docs":["用户的代币账户（存入的代币）"],"writable":true},{"name":"user_shares_account","docs":["用户的份额代币账户"],"writable":true},{"name":"vault_state","docs":["Mars Vault 状态账户"],"writable":true,"pda":{"seeds":[{"kind":"const","value":[118,97,117,108,116,45,115,116,97,116,101]},{"kind":"account","path":"vault_state.vault_id","account":"VaultState"}]}},{"name":"vault_treasury","docs":["Mars Vault 的代币金库"],"writable":true,"pda":{"seeds":[{"kind":"const","value":[118,97,117,108,116,45,116,114,101,97,115,117,114,121]},{"kind":"account","path":"vault_state.vault_id","account":"VaultState"}]}},{"name":"kamino_vault_state","docs":["Kamino Vault 状态账户（CPI 目标）"],"writable":true},{"name":"kamino_token_vault","docs":["Kamino 代币金库"],"writable":true},{"name":"kamino_shares_mint","docs":["Kamino 份额 Mint"]},{"name":"kamino_program","docs":["Kamino 程序"]},{"name":"token_program","address":"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{"name":"system_program","address":"11111111111111111111111111111111"}],"args":[{"name":"amount","type":"u64"}]},{"name":"vault_withdraw","docs":["用户从金库提款"],"discriminator":[98,28,187,98,87,69,46,64],"accounts":[{"name":"user","writable":true,"signer":true},{"name":"user_token_account","docs":["用户的代币账户（接收提取的代币）"],"writable":true},{"name":"user_shares_account","docs":["用户的份额代币账户"],"writable":true},{"name":"vault_state","docs":["Mars Vault 状态账户"],"writable":true,"pda":{"seeds":[{"kind":"const","value":[118,97,117,108,116,45,115,116,97,116,101]},{"kind":"account","path":"vault_state.vault_id","account":"VaultState"}]}},{"name":"vault_treasury","docs":["Mars Vault 的代币金库"],"writable":true},{"name":"kamino_vault_state","docs":["Kamino Vault 状态账户"],"writable":true},{"name":"kamino_token_vault","docs":["Kamino 代币金库"],"writable":true},{"name":"kamino_program","docs":["Kamino 程序"]},{"name":"token_program","address":"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"}],"args":[{"name":"shares_amount","type":"u64"}]}],"accounts":[{"name":"Asset","discriminator":[234,180,241,252,139,224,160,8]},{"name":"FeeTiers","discriminator":[206,145,108,161,95,145,80,78]},{"name":"GlobalState","discriminator":[163,46,74,168,216,123,133,98]},{"name":"GlobalStateAuthority","discriminator":[134,120,181,169,71,135,52,176]},{"name":"InsuranceFeeTiers","discriminator":[157,67,216,127,203,137,196,80]},{"name":"ProtocolFeeFraction","discriminator":[94,112,47,158,236,23,128,190]},{"name":"TargetChainMinFee","discriminator":[134,173,170,205,78,121,63,233]},{"name":"VaultState","discriminator":[228,196,82,165,98,210,235,152]}],"events":[{"name":"EmergencyEvent","discriminator":[58,86,35,38,218,1,117,209]},{"name":"FarmRewardsClaimedEvent","discriminator":[200,44,160,155,129,16,21,151]},{"name":"FeeConfigUpdated","discriminator":[45,50,42,173,193,67,52,244]},{"name":"PlatformFeeUpdatedEvent","discriminator":[7,32,168,42,6,254,146,165]},{"name":"PlatformFeeWalletUpdatedEvent","discriminator":[164,175,2,156,168,127,23,217]},{"name":"ProtocolConfigUpdated","discriminator":[20,99,32,237,111,86,195,199]},{"name":"RebalanceEvent","discriminator":[120,27,117,235,104,42,132,75]},{"name":"SwapEvent","discriminator":[64,198,205,232,38,8,113,226]},{"name":"VaultDepositEvent","discriminator":[187,186,196,189,175,44,10,64]},{"name":"VaultStateUpdated","discriminator":[135,163,160,0,255,108,92,219]},{"name":"VaultWithdrawEvent","discriminator":[192,143,53,201,67,20,212,195]}],"errors":[{"code":6000,"name":"InvalidKaminoProgram","msg":"无效的Kamino程序ID"},{"code":6001,"name":"InvalidAmount","msg":"金额必须大于0"},{"code":6002,"name":"InsufficientBalance","msg":"账户余额不足"}],"types":[{"name":"Asset","docs":["* Stores states of the assets of the pool"],"type":{"kind":"struct","fields":[{"name":"total_fee_collected","type":"u64"},{"name":"base_fee_collected","type":"u64"},{"name":"lp_fee_collected","type":"u64"},{"name":"protocol_fee_collected","type":"u64"},{"name":"insurance_fee_collected","type":"u64"},{"name":"unclaimed_base_fee","type":"u64"},{"name":"unclaimed_lp_fee","type":"u64"},{"name":"unclaimed_protocol_fee","type":"u64"},{"name":"unclaimed_insurance_fee","type":"u64"}]}},{"name":"EmergencyEvent","docs":["紧急状态事件"],"type":{"kind":"struct","fields":[{"name":"vault_id","type":{"array":["u8",32]}},{"name":"event_type","type":{"defined":{"name":"EmergencyEventType"}}},{"name":"reason","type":"string"},{"name":"executor","type":"pubkey"},{"name":"timestamp","type":"i64"}]}},{"name":"EmergencyEventType","type":{"kind":"enum","variants":[{"name":"Pause"},{"name":"Resume"},{"name":"EmergencyWithdraw"},{"name":"ForceRebalance"}]}},{"name":"FarmRewardsClaimedEvent","docs":["Farm 奖励领取事件"],"type":{"kind":"struct","fields":[{"name":"user","type":"pubkey"},{"name":"vault_mint","type":"pubkey"},{"name":"farm_state","type":"pubkey"},{"name":"reward_mint","type":"pubkey"},{"name":"reward_amount","type":"u64"},{"name":"platform_fee","type":"u64"},{"name":"total_rewards_claimed","type":"u64"},{"name":"timestamp","type":"i64"}]}},{"name":"FeeConfig","type":{"kind":"struct","fields":[{"name":"deposit_fee_bps","docs":["存款费用基点"],"type":"u16"},{"name":"withdraw_fee_bps","docs":["提款费用基点"],"type":"u16"},{"name":"management_fee_bps","docs":["管理费用基点（年化）"],"type":"u16"},{"name":"performance_fee_bps","docs":["性能费用基点"],"type":"u16"},{"name":"fee_recipient","docs":["费用接收地址"],"type":"pubkey"}]}},{"name":"FeeConfigUpdated","docs":["费用配置更新事件"],"type":{"kind":"struct","fields":[{"name":"vault_id","type":{"array":["u8",32]}},{"name":"deposit_fee_bps","type":"u16"},{"name":"withdraw_fee_bps","type":"u16"},{"name":"management_fee_bps","type":"u16"},{"name":"performance_fee_bps","type":"u16"},{"name":"timestamp","type":"i64"}]}},{"name":"FeeTier","type":{"kind":"struct","fields":[{"name":"threshold_amount","type":"u64"},{"name":"bps_fee","type":"u64"}]}},{"name":"FeeTiers","docs":["* Stores fee tiers to be levied"],"type":{"kind":"struct","fields":[{"name":"length","type":"u16"},{"name":"fee_tiers","type":{"vec":{"defined":{"name":"FeeTier"}}}}]}},{"name":"FeeType","repr":{"kind":"rust"},"type":{"kind":"enum","variants":[{"name":"Deposit"},{"name":"Withdraw"},{"name":"Management"},{"name":"Performance"}]}},{"name":"GlobalState","docs":["* Stores global state of the program"],"type":{"kind":"struct","fields":[{"name":"admin","type":"pubkey"},{"name":"pending_admin","type":{"option":"pubkey"}},{"name":"rebalance_threshold","type":"u16"},{"name":"cross_chain_fee_bps","type":"u16"},{"name":"base_mint","type":"pubkey"},{"name":"frozen","type":"bool"},{"name":"max_order_amount","type":"u64"},{"name":"platform_fee_wallet","type":"pubkey"},{"name":"unused_u64_1","type":"u64"},{"name":"unused_u64_2","type":"u64"}]}},{"name":"GlobalStateAuthority","type":{"kind":"struct","fields":[{"name":"freeze_authority","type":{"vec":"pubkey"}},{"name":"thaw_authority","type":{"vec":"pubkey"}}]}},{"name":"InsuranceFeeTier","type":{"kind":"struct","fields":[{"name":"threshold_amount","type":"u64"},{"name":"insurance_fee","type":"u64"}]}},{"name":"InsuranceFeeTiers","docs":["* Stores fee tiers to be levied"],"type":{"kind":"struct","fields":[{"name":"length","type":"u16"},{"name":"insurance_fee_tiers","type":{"vec":{"defined":{"name":"InsuranceFeeTier"}}}}]}},{"name":"PlatformFeeUpdatedEvent","docs":["平台费率更新事件"],"type":{"kind":"struct","fields":[{"name":"vault_id","type":{"array":["u8",32]}},{"name":"old_platform_fee_bps","type":"u16"},{"name":"new_platform_fee_bps","type":"u16"},{"name":"updated_by","type":"pubkey"},{"name":"timestamp","type":"i64"}]}},{"name":"PlatformFeeWalletUpdatedEvent","docs":["平台费钱包地址更新事件"],"type":{"kind":"struct","fields":[{"name":"old_wallet","type":"pubkey"},{"name":"new_wallet","type":"pubkey"},{"name":"updated_by","type":"pubkey"},{"name":"timestamp","type":"i64"}]}},{"name":"ProtocolConfig","type":{"kind":"struct","fields":[{"name":"protocol_id","docs":["协议ID（1=Kamino, 2=Lido, 等）"],"type":"u8"},{"name":"program_id","docs":["协议程序地址"],"type":"pubkey"},{"name":"enabled","docs":["协议状态（启用/禁用）"],"type":"bool"},{"name":"allocation_weight_bps","docs":["分配权重（基点，总和应该为10000）"],"type":"u16"},{"name":"current_allocation","docs":["当前在该协议中的资产数量"],"type":"u64"},{"name":"target_allocation_bps","docs":["目标分配比例"],"type":"u16"},{"name":"params","docs":["协议特定参数"],"type":"bytes"}]}},{"name":"ProtocolConfigUpdated","docs":["协议配置更新事件"],"type":{"kind":"struct","fields":[{"name":"vault_id","type":{"array":["u8",32]}},{"name":"protocol_id","type":"u8"},{"name":"enabled","type":"bool"},{"name":"allocation_weight_bps","type":"u16"},{"name":"target_allocation_bps","type":"u16"},{"name":"timestamp","type":"i64"}]}},{"name":"ProtocolFeeFraction","docs":["* Stores insurance fee fraction\\n * This is the fee that will be levied on the order amount\\n * to cover the insurance cost\\n * This is a fraction, so the numerator and denominator must be specified\\n * e.g. 1/10000 = 0.01% fee\\n * e.g. 1/1000 = 0.1% fee\\n * e.g. 1/100 = 1% fee"],"type":{"kind":"struct","fields":[{"name":"numerator","type":"u64"},{"name":"denominator","type":"u64"}]}},{"name":"RebalanceEvent","docs":["再平衡事件"],"type":{"kind":"struct","fields":[{"name":"vault_id","type":{"array":["u8",32]}},{"name":"protocol_from","type":"u8"},{"name":"protocol_to","type":"u8"},{"name":"amount_in","type":"u64"},{"name":"amount_out","type":"u64"},{"name":"executor","type":"pubkey"},{"name":"timestamp","type":"i64"}]}},{"name":"RebalanceRecord","type":{"kind":"struct","fields":[{"name":"protocol_from","docs":["源协议ID"],"type":"u8"},{"name":"protocol_to","docs":["目标协议ID"],"type":"u8"},{"name":"amount_in","docs":["输入数量"],"type":"u64"},{"name":"amount_out","docs":["输出数量"],"type":"u64"},{"name":"shares_received","docs":["获得的份额"],"type":"u64"},{"name":"timestamp","docs":["执行时间戳"],"type":"i64"},{"name":"executed_by","docs":["执行者标识（slot）"],"type":"u64"}]}},{"name":"SwapEvent","docs":["兑换事件"],"type":{"kind":"struct","fields":[{"name":"vault_id","type":{"array":["u8",32]}},{"name":"from_token","type":"pubkey"},{"name":"to_token","type":"pubkey"},{"name":"amount_in","type":"u64"},{"name":"amount_out","type":"u64"},{"name":"price_impact_bps","type":"u16"},{"name":"timestamp","type":"i64"}]}},{"name":"TargetChainMinFee","type":{"kind":"struct","fields":[{"name":"dest_chain_id","type":"u32"},{"name":"token_in","type":{"array":["u8",32]}},{"name":"min_fee","type":"u64"}]}},{"name":"UserDeposit","type":{"kind":"struct","fields":[{"name":"amount","docs":["用户存入的原始金额"],"type":"u64"},{"name":"shares","docs":["用户持有的份额数量"],"type":"u64"},{"name":"timestamp","docs":["存款时间戳"],"type":"i64"},{"name":"last_action_time","docs":["最后一次操作时间"],"type":"i64"},{"name":"total_rewards","docs":["累计获得的奖励"],"type":"u64"}]}},{"name":"UserDepositEntry","type":{"kind":"struct","fields":[{"name":"user","docs":["用户地址"],"type":"pubkey"},{"name":"deposit","docs":["用户存款信息"],"type":{"defined":{"name":"UserDeposit"}}}]}},{"name":"VaultDepositEvent","docs":["用户存款事件"],"type":{"kind":"struct","fields":[{"name":"user","type":"pubkey"},{"name":"vault_id","type":{"array":["u8",32]}},{"name":"amount","type":"u64"},{"name":"shares_received","type":"u64"},{"name":"protocol_id","type":"u8"},{"name":"timestamp","type":"i64"}]}},{"name":"VaultState","type":{"kind":"struct","fields":[{"name":"vault_id","docs":["金库唯一标识符"],"type":{"array":["u8",32]}},{"name":"admin","docs":["管理员地址"],"type":"pubkey"},{"name":"pending_admin","docs":["待接受的新管理员"],"type":{"option":"pubkey"}},{"name":"base_token_mint","docs":["基础代币 Mint（金库接受的主要代币）"],"type":"pubkey"},{"name":"shares_mint","docs":["份额代币 Mint（代表用户在金库中的权益）"],"type":"pubkey"},{"name":"treasury","docs":["金库Treasury账户（持有代币）"],"type":"pubkey"},{"name":"total_deposits","docs":["总存款数量"],"type":"u64"},{"name":"total_shares","docs":["总份额数量"],"type":"u64"},{"name":"created_at","docs":["金库创建时间"],"type":"i64"},{"name":"last_updated","docs":["最后更新时间"],"type":"i64"},{"name":"status","docs":["金库状态（活跃、暂停、已关闭）"],"type":{"defined":{"name":"VaultStatus"}}},{"name":"supported_protocols","docs":["支持的协议列表"],"type":{"vec":{"defined":{"name":"ProtocolConfig"}}}},{"name":"user_deposits","docs":["用户存款记录 (使用Vec存储)"],"type":{"vec":{"defined":{"name":"UserDepositEntry"}}}},{"name":"rebalance_history","docs":["再平衡记录"],"type":{"vec":{"defined":{"name":"RebalanceRecord"}}}},{"name":"fee_config","docs":["费用配置"],"type":{"defined":{"name":"FeeConfig"}}},{"name":"platform_fee_bps","docs":["平台费用基点（例如：100 = 1%）"],"type":"u16"},{"name":"max_slippage_bps","docs":["最大滑点保护基点"],"type":"u16"},{"name":"bump","docs":["PDA bump"],"type":"u8"},{"name":"unclaimed_deposit_fee","docs":["已收集但未认领的存款费用"],"type":"u64"},{"name":"unclaimed_withdraw_fee","docs":["已收集但未认领的提款费用"],"type":"u64"},{"name":"unclaimed_management_fee","docs":["已收集但未认领的管理费用"],"type":"u64"},{"name":"unclaimed_performance_fee","docs":["已收集但未认领的性能费用"],"type":"u64"},{"name":"total_deposit_fee_collected","docs":["总费用收集统计"],"type":"u64"},{"name":"total_withdraw_fee_collected","type":"u64"},{"name":"total_management_fee_collected","type":"u64"},{"name":"total_performance_fee_collected","type":"u64"},{"name":"total_rewards_claimed","docs":["总共领取的奖励数量（用于统计）"],"type":"u64"},{"name":"total_platform_fee_collected","docs":["总共收取的平台费（从奖励中收取）"],"type":"u64"},{"name":"reserved","docs":["保留字段用于未来扩展"],"type":{"array":["u8",48]}}]}},{"name":"VaultStateUpdated","docs":["金库状态更新事件"],"type":{"kind":"struct","fields":[{"name":"vault_id","type":{"array":["u8",32]}},{"name":"total_deposits","type":"u64"},{"name":"total_shares","type":"u64"},{"name":"apy","type":"u64"},{"name":"timestamp","type":"i64"}]}},{"name":"VaultStatus","type":{"kind":"enum","variants":[{"name":"Active"},{"name":"Paused"},{"name":"Closed"},{"name":"Emergency"}]}},{"name":"VaultWithdrawEvent","docs":["用户提款事件"],"type":{"kind":"struct","fields":[{"name":"user","type":"pubkey"},{"name":"vault_id","type":{"array":["u8",32]}},{"name":"shares_burned","type":"u64"},{"name":"amount_received","type":"u64"},{"name":"protocol_id","type":"u8"},{"name":"timestamp","type":"i64"}]}}]}'),j=t(85893),F=t(48764).Buffer,Z=u.Z.Title,K=u.Z.Text,D=u.Z.Paragraph,W=new A.PublicKey("Dfr6zir7nV2DWduqhtHNdkJn4mMxHf9G8muQSatiZ1k9"),C=new A.PublicKey("A2wsxhA7pF4B2UKVfXocb6TAAP9ipfPJam6oMKgDE5BK"),G=(new A.PublicKey("2b1kV6DkPAnxd5ixfnxCpjxmKwqjjaYmCZfHsFu24GXo"),function(){var e,a,t=(0,x.R)().connection,r=(0,P.O)(),o=c.Z.useForm(),m=d()(o,1)[0],u=c.Z.useForm(),G=d()(u,1)[0],N=(0,n.useState)(!1),E=d()(N,2),M=E[0],B=E[1],U=(0,n.useState)(!1),R=d()(U,2),Q=R[0],L=R[1],I=(0,n.useState)(""),J=d()(I,2),z=(J[0],J[1]),X=(0,n.useState)(null),q=d()(X,2),H=q[0],Y=q[1],O=(0,n.useState)(""),$=d()(O,2),ee=$[0],ae=$[1],te=function(){var e=i()(s()().mark((function e(){var a,n,o,i,u,c,p,_,y,b,k,f,g;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,L(!0),a=new S.Y7(t,r,{commitment:"confirmed"}),n=new S.$r(V,a),o=A.PublicKey.findProgramAddressSync([F.from("vault-state"),C.toBuffer()],W),i=d()(o,1),u=i[0],c=A.PublicKey.findProgramAddressSync([F.from("mars-global-state-seed")],W),p=d()(c,1),_=p[0],e.next=8,n.account.vaultState.fetch(u);case 8:return y=e.sent,b=y.platformFeeBps,Y(k=b/100),m.setFieldsValue({platformFeeRate:k}),e.next=15,n.account.globalState.fetch(_);case 15:f=e.sent,g=f.platformFeeWallet.toBase58(),ae(g),G.setFieldsValue({newFeeWallet:g}),console.log("链上数据:",{platformFeeBps:b,platformFeePercent:k,feeWallet:g}),e.next=26;break;case 22:e.prev=22,e.t0=e.catch(0),console.error("读取链上数据失败:",e.t0),l.ZP.warning("无法读取链上配置，请检查网络连接");case 26:return e.prev=26,L(!1),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[0,22,26,29]])})));return function(){return e.apply(this,arguments)}}();(0,n.useEffect)((function(){te()}),[]);var ne,re=function(){var e=i()(s()().mark((function e(){var a,n,o,i,u,c,_,y;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.publicKey&&r.signTransaction){e.next=3;break}return l.ZP.error("请先连接钱包"),e.abrupt("return");case 3:return e.prev=3,B(!0),e.next=7,m.validateFields();case 7:if(a=e.sent,!((n=Math.round(100*a.platformFeeRate))<0||n>1e4)){e.next=12;break}return l.ZP.error("费率必须在 0-100% 之间"),e.abrupt("return");case 12:return o=A.PublicKey.findProgramAddressSync([F.from("vault-state"),C.toBuffer()],W),i=d()(o,1),u=i[0],c=new S.Y7(t,r,{commitment:"confirmed"}),_=new S.$r(V,c),l.ZP.loading({content:"正在构建交易...",key:"tx"}),e.next=18,_.methods.updateVaultPlatformFee(new S.BN(n)).accountsPartial({admin:r.publicKey,vaultState:u}).rpc();case 18:return y=e.sent,z(y),l.ZP.success({content:"平台费率已更新为 ".concat(a.platformFeeRate,"%"),key:"tx"}),e.next=23,te();case 23:p.Z.success({title:"交易成功",content:(0,j.jsxs)("div",{children:[(0,j.jsxs)("p",{children:["平台费率已成功更新为 ",a.platformFeeRate,"%"]}),(0,j.jsx)("p",{children:"交易签名:"}),(0,j.jsx)("a",{href:"https://solscan.io/tx/".concat(y),target:"_blank",rel:"noopener noreferrer",style:{wordBreak:"break-all"},children:y})]})}),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(3),console.error("更新失败:",e.t0),l.ZP.error({content:"更新失败: ".concat(e.t0.message),key:"tx"});case 30:return e.prev=30,B(!1),e.finish(30);case 33:case"end":return e.stop()}}),e,null,[[3,26,30,33]])})));return function(){return e.apply(this,arguments)}}(),se=function(){var e=i()(s()().mark((function e(){var a,n,o,i,m,u,c,_;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.publicKey&&r.signTransaction){e.next=3;break}return l.ZP.error("请先连接钱包"),e.abrupt("return");case 3:return e.prev=3,B(!0),e.next=7,G.validateFields();case 7:a=e.sent,e.prev=8,n=new A.PublicKey(a.feeWallet),e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(8),l.ZP.error("无效的 Solana 地址格式"),e.abrupt("return");case 16:return o=A.PublicKey.findProgramAddressSync([F.from("mars-global-state-seed")],W),i=d()(o,1),m=i[0],u=new S.Y7(t,r,{commitment:"confirmed"}),c=new S.$r(V,u),l.ZP.loading({content:"正在构建交易...",key:"tx"}),e.next=22,c.methods.updatePlatformFeeWallet(n).accountsPartial({admin:r.publicKey,globalState:m}).rpc();case 22:return _=e.sent,z(_),l.ZP.success({content:"平台费用钱包已更新",key:"tx"}),p.Z.success({title:"交易成功",content:(0,j.jsxs)("div",{children:[(0,j.jsx)("p",{children:"平台费用钱包已成功更新"}),(0,j.jsxs)("p",{children:["新钱包地址: ",a.feeWallet]}),(0,j.jsx)("p",{children:"交易签名:"}),(0,j.jsx)("a",{href:"https://solscan.io/tx/".concat(_),target:"_blank",rel:"noopener noreferrer",style:{wordBreak:"break-all"},children:_})]})}),e.next=28,te();case 28:e.next=34;break;case 30:e.prev=30,e.t1=e.catch(3),console.error("更新失败:",e.t1),l.ZP.error({content:"更新失败: ".concat(e.t1.message),key:"tx"});case 34:return e.prev=34,B(!1),e.finish(34);case 37:case"end":return e.stop()}}),e,null,[[3,30,34,37],[8,12]])})));return function(){return e.apply(this,arguments)}}();return(0,j.jsx)(T._z,{header:{title:"区块链设置",subTitle:"Solana 链上配置管理",extra:(0,j.jsx)(w.a,{})},children:(0,j.jsxs)(_.Z,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,j.jsx)(y.Z,{message:"功能说明",description:"您可以通过连接 Solana 钱包直接在管理后台执行链上交易。所有操作都会在区块链上记录，确保透明和可追溯。",type:"info",showIcon:!0}),(0,j.jsx)(b.Z,{title:"钱包连接状态",children:r.connected?(0,j.jsxs)(_.Z,{direction:"vertical",size:"small",children:[(0,j.jsxs)(_.Z,{children:[(0,j.jsx)(K,{strong:!0,children:"状态:"}),(0,j.jsx)(K,{style:{color:"#52c41a"},children:"✅ 已连接"})]}),(0,j.jsxs)(_.Z,{children:[(0,j.jsx)(K,{strong:!0,children:"钱包类型:"}),(0,j.jsx)(K,{children:(null===(e=r.wallet)||void 0===e?void 0:e.adapter.name)||"未知"})]}),(0,j.jsxs)(_.Z,{children:[(0,j.jsx)(K,{strong:!0,children:"地址:"}),(0,j.jsx)(K,{code:!0,copyable:!0,children:null===(a=r.publicKey)||void 0===a?void 0:a.toBase58()})]})]}):(0,j.jsxs)(_.Z,{direction:"vertical",children:[(0,j.jsx)(K,{children:"❌ 未连接钱包"}),(0,j.jsx)(D,{type:"secondary",children:'请点击右上角的"Select Wallet"按钮连接您的 Phantom 或 Solflare 钱包。'})]})}),(0,j.jsx)(k.Z,{}),(0,j.jsxs)(b.Z,{title:"平台费率设置",extra:null!==H?(0,j.jsxs)(K,{type:"secondary",children:["链上当前费率: ",H,"% (",Math.round(100*H)," BPS)"]}):(0,j.jsx)(f.Z,{size:"small"}),children:[Q&&(0,j.jsx)(y.Z,{message:"正在从链上读取当前配置...",type:"info",showIcon:!0,style:{marginBottom:16}}),(0,j.jsxs)(c.Z,{form:m,layout:"vertical",children:[(0,j.jsx)(c.Z.Item,{label:"平台费率 (%)",name:"platformFeeRate",rules:[{required:!0,message:"请输入费率"},{type:"number",min:0,max:100,message:"费率范围: 0-100%"}],extra:"输入百分比，例如 25 表示 25%。系统会自动转换为基点 (BPS)",children:(0,j.jsx)(g.Z,{style:{width:200},precision:2,step:.01,addonAfter:"%",disabled:!r.connected})}),(0,j.jsx)(y.Z,{message:"备用方案：CLI 命令",description:(0,j.jsx)("code",{style:{display:"block",padding:"8px",background:"#f5f5f5",borderRadius:"4px"},children:"cd contracts-solana && yarn script update-vault-platform-fee -m 2b1kV6DkPAnxd5ixfnxCpjxmKwqjjaYmCZfHsFu24GXo -f 2500"}),type:"info",style:{marginBottom:16}}),(0,j.jsx)(v.ZP,{type:"primary",onClick:re,loading:M,disabled:!r.connected,children:"更新平台费率"})]})]}),(0,j.jsx)(k.Z,{}),(0,j.jsx)(b.Z,{title:"平台费用钱包",extra:ee?(0,j.jsxs)(K,{type:"secondary",children:["当前钱包: ",ee.slice(0,8),"...",ee.slice(-6)]}):(0,j.jsx)(f.Z,{size:"small"}),children:(0,j.jsxs)(c.Z,{form:G,layout:"vertical",children:[(0,j.jsx)(c.Z.Item,{label:"新钱包地址",name:"feeWallet",rules:[{required:!0,message:"请输入钱包地址"},{validator:(ne=i()(s()().mark((function e(a,t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:e.prev=2,new A.PublicKey(t),e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(2),new Error("无效的 Solana 地址格式");case 9:case"end":return e.stop()}}),e,null,[[2,6]])}))),function(e,a){return ne.apply(this,arguments)})}],extra:ee?(0,j.jsx)(_.Z,{direction:"vertical",size:"small",style:{marginTop:8},children:(0,j.jsxs)(K,{type:"secondary",children:["当前钱包地址:",(0,j.jsx)(K,{code:!0,copyable:!0,style:{marginLeft:8},children:ee})]})}):null,children:(0,j.jsx)(h.Z,{placeholder:"输入新的 Solana 钱包地址",disabled:!r.connected})}),(0,j.jsx)(y.Z,{message:"备用方案：CLI 命令",description:(0,j.jsx)("code",{style:{display:"block",padding:"8px",background:"#f5f5f5",borderRadius:"4px"},children:"cd contracts-solana && yarn script update-platform-fee-wallet -w YOUR_NEW_WALLET_ADDRESS"}),type:"info",style:{marginBottom:16}}),(0,j.jsx)(v.ZP,{type:"primary",onClick:se,loading:M,disabled:!r.connected,children:"更新费用钱包"})]})}),(0,j.jsx)(k.Z,{}),(0,j.jsx)(b.Z,{title:"使用说明",children:(0,j.jsxs)(_.Z,{direction:"vertical",size:"middle",style:{width:"100%"},children:[(0,j.jsxs)("div",{children:[(0,j.jsx)(Z,{level:5,children:"1. 连接钱包"}),(0,j.jsx)(D,{children:'点击右上角的"Select Wallet"按钮，选择 Phantom 或 Solflare 钱包进行连接。 确保您的钱包地址是合约的管理员地址，否则交易会失败。'})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)(Z,{level:5,children:"2. 更新平台费率"}),(0,j.jsx)(D,{children:"输入新的费率百分比（0-100%），点击更新按钮。钱包会弹出确认窗口，确认后交易将提交到链上。 交易确认后，新的费率将立即生效。"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)(Z,{level:5,children:"3. 更新费用钱包"}),(0,j.jsx)(D,{children:"输入新的 Solana 钱包地址，系统会验证地址格式。确认无误后点击更新按钮， 在钱包中确认交易。所有平台费用将发送到新的钱包地址。"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)(Z,{level:5,children:"4. 权限说明"}),(0,j.jsx)(D,{type:"warning",children:"⚠️ 只有智能合约的管理员地址可以执行这些操作。如果您使用非管理员地址， 交易将失败并消耗 gas 费用。请确保使用正确的管理员钱包。"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)(Z,{level:5,children:"5. 备用方案"}),(0,j.jsx)(D,{children:"如果您遇到钱包连接问题或需要批量操作，可以使用 contracts-solana 项目中的 CLI 工具。 请参考上方卡片中的 CLI 命令示例。"})]})]})})]})})}),N=function(){return(0,j.jsx)(G,{})}}}]);